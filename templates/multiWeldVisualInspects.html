<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weld Visual Inspections</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            font-family: Arial, sans-serif;
            margin-bottom: 20px; /* Space between tables */
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
            font-size: 12px;
        }
        .header {
            font-weight: bold;
            font-size: 14px;
        } 
        @media print {
            thead {
                display: table-header-group; /* Repeat headers on each page */
            }
            tr.page-break {
                page-break-after: always; /* Force page break after each table */
            }
        }
    </style>
</head>
<body>      

<% 
    let itemsPerPage = 6; 
    let totalPages = Math.ceil(items.length / itemsPerPage);
    for (let page = 0; page < totalPages; page++) { 
        let start = page * itemsPerPage;
        let end = start + itemsPerPage;
        let currentItems = items.slice(start, end);
%>
    <table>
        <thead>
            <tr>
                <td colspan="18" class="header">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center;">
                            <img
                                src="<%= logoUrl1 %>"
                                alt="Company Logo"
                                style="max-width: 100px; height: 100px; margin-right: 20px;"
                            />
                            <img
                                src="<%= logoUrl2 %>"
                                alt="Company Logo"
                                style="max-width: 100px; height: 100px;"
                            />
                            <div style="text-align: center; font-size: 24px; margin-left: 20px;">
                                <strong>VISHAL ENTERPRISE & VRISHAL ENGINEERING PRIVATE LIMITED</strong><br />
                                GROUP OF COMPANIES<br />
                            </div>
                        </div>
                       
                        <img
                            src="<%= logoUrl2 %>"
                            alt="Company Logo"
                            style="max-width: 100px; height: 100px;"
                        />
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="18" class="header">WELD VISUAL INSPECTION LIST</td>
            </tr> 
            <tr>
                <td colspan="1" class="header">CLIENT</td>
                <td colspan="5"><%= headerInfo.client %></td>
                <td colspan="2" class="header">PROJECT</td>
                <td colspan="10"><%= headerInfo.project_name %></td>  
            </tr>
            <tr>
                <td colspan="1" class="header">WO NO./PO NO.</td>
                <td colspan="5"><%= headerInfo.wo_no %></td>
                <td colspan="2" class="header">PROJECT PO NO.</td>
                <td colspan="10"><%= headerInfo.project_po_no %></td>  
            </tr>

          
            <tr>
                <th style="width: 5%;">SR No.</th>
                <th style="width: 10%;">REPORT NO.</th>
                <th style="width: 10%;">DATE</th>
                <th style="width: 10%;">DRAWING NO.</th>
                <th style="width: 5%;">REV.NO.</th>
                <th style="width: 10%;">ASSEMBLY NUMBER</th>
                <th style="width: 10%;">GRID NUMBER</th>
                <th style="width: 10%;">ITEM NUMBER</th>
                <th style="width: 5%;">QTY(Nos)</th>
                <th style="width: 5%;">PROFILE</th>
                <th style="width: 5%;">TYPE OF WELD</th>
                <th style="width: 5%;">WPS NO.</th>
                <th style="width: 5%;">WELDING PROCESS</th>
                <th style="width: 5%;">WELDER NO.</th>
                <th style="width: 5%;">FIT-UP REPORT NO.</th>
                <th style="width: 5%;">ACC/REJ</th>
                <th>REMARKS</th>             
            </tr>

        </thead>
        <tbody>

        <% currentItems.forEach((item, index) => { %>
            <tr>
                <td><%= start + index + 1 %></td> 
                <td><%= item.report_no %></td>
                <td><%= item.date %></td>
                <td><%= item.drawing_no %></td>
                <td><%= item.rev %></td>
                <td><%= item.assembly_no || '--' %></td>
                <td><%= item.grid_no || '--' %></td>
                <td><%= item.item_no || '--' %></td>
                <td><%= item.qty || '--' %></td>
                <td><%= item.profile || '--' %></td>
                <td><%= item.joint_type || '--' %></td>
                <td><%= item.wps_no || '--' %></td>
                <td><%= item.weld_process || '--' %></td>
                <td><%= item.welder_no || '--' %></td>
                <td><%= item.fit_up_no || '--' %></td>  
                <td><%= item.accept || '--' %></td>         
                <td class="remarks"><%= item.remarks || '--' %></td> 
            </tr>

        <% }); %>
            <tr>
              <td colspan="2" class="header">QC CHECK SHEET</td>
              <td colspan="16" class="header">CHECKED  &nbsp;&nbsp; &#10004; &nbsp; &#10008; &nbsp;&nbsp; NOT APPLICABLE</td>
            </tr>
            <tr>
              <td colspan="2" class="header">DOCUMENT VERIFICATION</td>
              <td colspan="4" class="header">MARKING VERIFICATION CHECK</td>
              <td colspan="8" class="header">WELD SURFACE DEFECT CHECK</td>
              <td colspan="6" class="header">VISUAL CHECK</td>
            </tr>
            <tr>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> APPROVED NDT DRG./TESTPLAN WITH LATEST REV.<br />
                <input type="checkbox" /> QUALIFIED WELDER LIST<br />
                <input type="checkbox" /> APPROVED WPS
              </td>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> JOINT NO.<br />
                <input type="checkbox" /> WELDER NO.
              </td>
              <td colspan="1" style="text-align: left;">
                <input type="checkbox" /> SPATTER<br />
                <input type="checkbox" /> UNDER CUT
              </td>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> REINFORCEMENT<br />
                <input type="checkbox" /> LUMPS/HIGH SPOT
              </td>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> POROSITY/PIN HOLES<br />
                <input type="checkbox" /> BEAD APEARANCE/WEAVING
              </td>
              <td colspan="1" style="text-align: left;">
                <input type="checkbox" /> SLAG<br />
                <input type="checkbox" /> WELD SIZE
              </td>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> CRACK<br />
                <input type="checkbox" /> BUNDER FILL
              </td>
              <td colspan="2" style="text-align: left;">
                <input type="checkbox" /> ARC STRIKE<br />
                <input type="checkbox" /> CLEAT MARK<br />
                <input type="checkbox" /> PHYSICAL CONDITION
              </td>
              <td colspan="4" style="text-align: left;">
                <input type="checkbox" /> DISTORTION<br />
                <input type="checkbox" /> CORNER SEALING/ROUNDING
              </td>
            </tr>
            <tr>
              <td colspan="2"></td>
              <td colspan="7" class="header">VE QC</td>
              <td colspan="9" class="header">CLIENT QC/TPI</td>
            </tr>
            <tr>
              <td colspan="2">SIGNATURE</td>
              <td colspan="7"></td>
              <td colspan="9"></td>
            </tr>
            <tr>
              <td colspan="2">NAME</td>
              <td colspan="7"></td>
              <td colspan="9"></td>
            </tr>
            <tr>
              <td colspan="2">DATE</td>
              <td colspan="7">
              
              </td>
              <td colspan="9"></td>
            </tr>
            

        </tbody>

    </table>

<% if (page !== totalPages - 1) { %> 
    <div class="page-break"></div> 
<% } } %>

</body>
</html>
