<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Usable stock list</title>
        <style>
            table {
                width: 100%;
                border-collapse: collapse;
                font-family: Arial, sans-serif;
                margin-bottom: 14px;
            }
            th,
            td {
                border: 1px solid black;
                padding: 8px 4px;
                text-align: center;
                font-size: 9px;
            }
            .header {
                font-weight: bold;
                font-size: 10px;
            }
            .footer {
                font-weight: bold;
                text-align: left;
                font-size: 10px;
                margin-top: 20px;
            }
            .left-alignment {
                text-align: left;
            }
            .truncate-cell {
                height: 10px;
                max-height: 10px;
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
            }
            @media print {
                thead {
                    display: table-header-group; /* Repeat headers on each page */
                }
                tfoot {
                    display: table-footer-group; /* Ensure footer is on the last page */
                }
                tr.page-break {
                    page-break-after: always; /* Force page break after each table */
                }
            }
        </style>
    </head>
    <body>
        <% 
            let itemsPerPage = 16; 
            let totalPages = Math.ceil(items.length / itemsPerPage);
            for (let page = 0; page < totalPages; page++) { 
                let start = page * itemsPerPage;
                let end = start + itemsPerPage;
                let currentItems = items.slice(start, end);
        %>
        <table>
            <thead>
                <tr>
                    <td colspan="16" class="header">
                        <div style="display: flex; align-items: center; justify-content: center;">
                            <img
                            src="<%= logoUrl1 %>"
                            alt="Company Logo"
                            style="max-width: 200px; height: 80px; margin-right: 20px;"
                            />
                            <div style="flex: 1; text-align: center; font-size: 20px;">
                                <strong>VISHAL ENTERPRISE & VRISHAL ENGINEERING PRIVATE LIMITED</strong><br />
                                GROUP OF COMPANIES<br />
                            </div>
                        </div>
                    </td>
                </tr> 
                <tr>
                    <td colspan="16" class="header">
                        PROJECT MATERIAL USABLE LIST
                    </td>
                </tr>
                <tr>
                    <th>SR NO.</th>
                    <th>PROJECT NAME</th>
                    <th>MATERIAL PO NO.</th>
                    <th>SECTION DETAIL</th>
                    <th>GRADE</th>
                    <th>UOM</th>
                    <th>STOCK QTY/AVAILABLE QTY</th>
                    <th>MANUFACTURER</th>
                    <th>SUPPLIER</th>
                    <th>IMIR NO.</th>
                    <th>HEAT NUMBER</th>
                    <th>USABLE LENGTH</th>
                    <th>USABLE WIDTH</th>
                    <th>USABLE NOS</th>
                    <th>USABLE QTY</th>
                    <th>REMARKS</th>
                </tr>
            </thead>
            <tbody>
                <% currentItems.forEach((detail, index) => { %>
                    <tr>
                        <td class="truncate-cell"><%= start + index + 1 %></td> 
                        <td class="truncate-cell"><%= detail.project_name || '--' %></td>
                        <td class="truncate-cell"><%= detail.material_po_no || '--' %></td>
                        <td class="truncate-cell"><%= detail.item_name || '--' %></td>
                        <td class="truncate-cell"><%= detail.material_grade || '--' %></td>
                        <td class="truncate-cell"><%= detail.unit || '--' %></td>
                        <td class="truncate-cell"><%= (detail.balance_qty || 0).toFixed(3) %></td>
                        <td class="truncate-cell"><%= detail.manufacture_name || '--' %></td>
                        <td class="truncate-cell"><%= detail.supplier_name || '--' %></td>
                        <td class="truncate-cell"><%= detail.imir_no || '--' %></td>
                        <td class="truncate-cell"><%= detail.accepted_lot_no || '--' %></td>
                        <td class="truncate-cell"><%= (detail.usableLength || 0).toFixed(2) %></td>
                        <td class="truncate-cell"><%= (detail.usableWidth || 0).toFixed(2) %></td>
                        <td class="truncate-cell"><%= detail.usableNos || '--' %></td>
                        <td class="truncate-cell"><%= (detail.usableQty || 0).toFixed(3) %></td>
                        <td class="truncate-cell"><%= detail.remarks || '--' %></td>
                    </tr>
                <% }) %>
            </tbody>
            <tr>
                <td colspan="16" style="text-align: left;">VE-DOC-31 REV.00 </td>
            </tr>
        </table>
        <% if (page !== totalPages - 1) { %> 
            <div class="page-break"></div> 
        <% } } %>
    </body>             
</html>