<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Main Store Stock List</title>
    <style>
      body {
          font-family: Arial, sans-serif;
          margin: 0;
          padding: 0;
      }
      table {
          width: 100%;
          border-collapse: collapse;
      }
      th, td {
          border: 1px solid black;
          padding: 8px;
          text-align: center;
          font-size: 12px;
      }
      .header {
          font-weight: bold;
          font-size: 14px;
      } 
      .header1 {
          font-weight: bold;
          font-size: 12px;
      } 

      .signature-section td {
          height: 50px;
      }
  
      .remarks {
          height: 100px;
      }
   
    </style>
  </head>
  <body>
    <div>
      <table>
        <thead>
          <tr>
            <td colspan="14" class="header">
              <div style="display: flex; align-items: center; justify-content: center;">
                <img
                    src="<%= logoUrl1 %>"
                    alt="Company Logo"
                    style="max-width: 80px; height: 80px; margin-right: 10px;"
                />
                <div style="flex: 1; text-align: center; font-size: 20px;">
                  <strong>VISHAL ENTERPRISE & VRISHAL ENGINEERING PRIVATE LIMITED</strong><br />
                      GROUP OF COMPANIES<br />
                </div>
                <img
                    src="<%= logoUrl2 %>"
                    alt="Company Logo"
                    style="max-width: 80px; height: 80px; margin-right: 0px;"
                />
              </div>
            </td>
          </tr>
          
          <% if (requestData.sdate&&requestData.edate) { %>
            <tr>
              <td colspan="2" class="header">MAIN STORE STOCK LIST</td>
              <td colspan="7" class="header1">Date &nbsp;&nbsp; : &nbsp;&nbsp; <%= new Date(requestData.sdate).toLocaleDateString()%>&nbsp;&nbsp;&nbsp; To &nbsp;&nbsp;&nbsp;<%= new Date(requestData.edate).toLocaleDateString()%> </td>
            </tr>
          <% } else { %>
            <tr>
              <td colspan="13" class="header">MAIN STORE STOCK LIST</td>
            </tr>
          <% }%>
          <tr class="">
            <th style="width: 25px;">SR. NO.</th>
            <th style="width: 180px;">ITEM NAME</th>
            <th style="width: 90px;">MATERIAL GRADE</th>
            <th style="width: 50px;">UNIT</th>
            <th style="width: 90px;">M_CODE</th>
            <th style="width: 50px;">OP. QTY</th>
            <th style="width: 50px;">IN QTY.</th>
            <th style="width: 50px;">OUT QTY.</th>
            <th style="width: 50px;">BALANCE QTY.</th>
          </tr>
        </thead>
        <tbody>
                <% requestData.store_items.forEach(function(order, index) { %>
                  <tr>
                    <td><%= index + 1 %></td>
                    <td><%= order.item_name || '--' %></td>
                    <td><%= order.material_grade || '--' %></td>
                    <td><%= order.unit || '--' %></td>
                    <td><%= order.m_code || '--' %></td>
                    <td><%= (order.opening_balance ? order.opening_balance.toFixed(3) : '0') %></td>
                    <td><%= (order.date_totalIn ? order.date_totalIn.toFixed(3) : '0') %></td>
                    <td><%= (order.date_totalOut ? order.date_totalOut.toFixed(3) : '0') %></td>
                    <td><%= (order.balance ? order.balance.toFixed(3) : '0') %></td>
                  </tr>
                <% }) %>
              <tr style="height: 50px;">
                <th colspan="5" >TOTAL</th>
                <th><%= (requestData.total_op_bal ? requestData.total_op_bal.toFixed(3) : '0') %></th>
                <th><%= (requestData.total_in ? requestData.total_in.toFixed(3) : '0') %></th>
                <th><%= (requestData.total_out ? requestData.total_out.toFixed(3) : '0') %></th>
                <th><%= (requestData.total_balance ? requestData.total_balance.toFixed(3) : '0') %></th>
              </tr>
        </tbody>
      </table> 
    </div>
  </body>
</html>